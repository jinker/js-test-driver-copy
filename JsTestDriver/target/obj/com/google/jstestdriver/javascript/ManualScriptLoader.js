jstestdriver.ManualScriptLoader=function(c,b,a){this.win_=c;this.testCaseManager_=b;this.now_=a;this.onFileLoaded_=null;this.started_=-1;this.file_=null;this.fileMap_={};this.errorHandler_=this.createErrorHandler()};jstestdriver.ManualScriptLoader.prototype.beginLoad=function(a,b){this.fileMap_[a.fileSrc]=a;this.testCaseManager_.removeTestCaseForFilename(a.fileSrc);this.file_=a;this.win_.onerror=this.errorHandler_;this.started_=this.now_();this.onFileLoaded_=b;jstestdriver.log("loading "+a.fileSrc)};jstestdriver.ManualScriptLoader.prototype.endLoad=function(c){var b=this.now_()-this.started_;if(b>50){jstestdriver.log("slow load "+this.file_.fileSrc+" in "+b)}this.testCaseManager_.updateLatestTestCase(c.fileSrc);var a=new jstestdriver.FileResult(c,true,"",this.now_()-this.started_);this.onFileLoaded_(a)};jstestdriver.ManualScriptLoader.prototype.createErrorHandler=function(){var a=this;return function(i,e,d){var h=e.indexOf("/test/");var f=h>-1?e.substr(h,e.length-h):e;var g=a.fileMap_[f];jstestdriver.log("failed load "+f+" in "+(a.now_()-a.started_));var c=a.started_;a.started_=-1;var b="error loading file: "+f;if(d!=undefined&&d!=null){b+=":"+d}if(i!=undefined&&i!=null){b+=": "+i}a.win_.onerror=jstestdriver.EMPTY_FUNC;a.onFileLoaded_(new jstestdriver.FileResult(g,false,b,a.now_()-c))}};